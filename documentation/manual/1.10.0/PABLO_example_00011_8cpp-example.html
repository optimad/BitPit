---
layout: doxygen_header
title: Manual - PABLO_example_00011.cpp
section: documentation
doxygen-show-titlearea: 0
extra-head-includes:
    - doxygen_extra_head.html
---
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
{% if page.doxygen-show-titlearea == 1 %}
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">bitpit
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
{% endif %}
<!-- end header part -->
{% raw %}
<!-- Generated by Doxygen 1.10.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">PABLO_example_00011.cpp</div></div>
</div><!--header-->
<div class="contents">
<p>3D adaptive mesh refinement (AMR) using PABLO</p>
<p>3D adaptive mesh refinement (AMR) using PABLOThis example creates a 3D Octree mesh on the cube domain [0,1]x[0,1]x[0,1].</p>
<p>The domain is refined globally one time and periodic conditions are imposed on the boundaries of the domain. Then, the face, vertex and edge neighbors of the cells are found and print.</p>
<p><b>To run</b>: ./PABLO_example_00011 <br  />
 Thanks to <a href="https://www.surrey.ac.uk/people/maxime-delorme">Maxime Delorme</a> for this example.</p>
<div class="fragment"><div class="line"><span class="comment">/*---------------------------------------------------------------------------*\</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  bitpit</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  Copyright (C) 2015-2021 OPTIMAD engineering Srl</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  -------------------------------------------------------------------------</span></div>
<div class="line"><span class="comment"> *  License</span></div>
<div class="line"><span class="comment"> *  This file is part of bitpit.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  bitpit is free software: you can redistribute it and/or modify it</span></div>
<div class="line"><span class="comment"> *  under the terms of the GNU Lesser General Public License v3 (LGPL)</span></div>
<div class="line"><span class="comment"> *  as published by the Free Software Foundation.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  bitpit is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><span class="comment"> *  ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><span class="comment"> *  FITNESS FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public</span></div>
<div class="line"><span class="comment"> *  License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  You should have received a copy of the GNU Lesser General Public License</span></div>
<div class="line"><span class="comment"> *  along with bitpit. If not, see &lt;http://www.gnu.org/licenses/&gt;.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment">\*---------------------------------------------------------------------------*/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if BITPIT_ENABLE_MPI==1</span></div>
<div class="line"><span class="preprocessor">#include &lt;mpi.h&gt;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;bitpit_PABLO.hpp&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span>bitpit;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// =================================================================================== //</span></div>
<div class="line"><span class="comment">// =================================================================================== //</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> run()</div>
<div class="line">{</div>
<div class="line">    <a id="_a0" name="_a0"></a><a class="code hl_class" href="classbitpit_1_1PabloUniform.html">PabloUniform</a> pablo11(3);</div>
<div class="line"> </div>
<div class="line">    pablo11.<a id="a1" name="a1"></a><a class="code hl_function" href="classbitpit_1_1ParaTree.html#ad6b41c3482514a04d177f8c414d4ac75">setPeriodic</a>(0);</div>
<div class="line">    pablo11.<a class="code hl_function" href="classbitpit_1_1ParaTree.html#ad6b41c3482514a04d177f8c414d4ac75">setPeriodic</a>(2);</div>
<div class="line">    pablo11.<a class="code hl_function" href="classbitpit_1_1ParaTree.html#ad6b41c3482514a04d177f8c414d4ac75">setPeriodic</a>(4);</div>
<div class="line"> </div>
<div class="line">    pablo11.<a id="a2" name="a2"></a><a class="code hl_function" href="classbitpit_1_1ParaTree.html#a41d99b9833493d8b18bf927418bf7598">computeConnectivity</a>();</div>
<div class="line">    pablo11.<a id="a3" name="a3"></a><a class="code hl_function" href="classbitpit_1_1PabloUniform.html#a7bc85b54fb9ed262cad6e4e6d43f8716">write</a>(<span class="stringliteral">&quot;pablo000011.0&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    pablo11.<a id="a4" name="a4"></a><a class="code hl_function" href="classbitpit_1_1ParaTree.html#a5eacb88f2324b915ba8dbac95c994755">adaptGlobalRefine</a>();</div>
<div class="line">    pablo11.<a id="a5" name="a5"></a><a class="code hl_function" href="classbitpit_1_1ParaTree.html#ab4aa4521f6f8b2c046ad2bcb57bf568d">updateConnectivity</a>();</div>
<div class="line">    pablo11.<a class="code hl_function" href="classbitpit_1_1PabloUniform.html#a7bc85b54fb9ed262cad6e4e6d43f8716">write</a>(<span class="stringliteral">&quot;pablo000011.1&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    uint32_t nOct = pablo11.<a id="a6" name="a6"></a><a class="code hl_function" href="classbitpit_1_1ParaTree.html#a1494818960f36f09090597a10eac9fff">getNumOctants</a>();</div>
<div class="line">    log::cout() &lt;&lt; <span class="stringliteral">&quot;Number of Octants : &quot;</span> &lt;&lt; nOct &lt;&lt; std::endl;</div>
<div class="line">    log::cout() &lt;&lt; <span class="stringliteral">&quot;Extracting the four face neighbours of each Octant &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t iOct = 0; iOct &lt; nOct; ++iOct) {</div>
<div class="line">        std::vector&lt;uint32_t&gt; neigh;</div>
<div class="line">        std::vector&lt;bool&gt; isGhost;</div>
<div class="line">        log::cout() &lt;&lt; <span class="stringliteral">&quot;. Octant index : &quot;</span> &lt;&lt; iOct &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">for</span> (uint8_t iFace=0; iFace&lt;pablo11.<a id="a7" name="a7"></a><a class="code hl_function" href="classbitpit_1_1ParaTree.html#ab63134bd6077b2cdb109cc3b51fc8951">getNfaces</a>(); ++iFace) {</div>
<div class="line">            pablo11.<a id="a8" name="a8"></a><a class="code hl_function" href="classbitpit_1_1ParaTree.html#a68ce3495da48681134c439abc47db841">findNeighbours</a>(iOct, iFace, 1, neigh, isGhost);</div>
<div class="line">            log::cout() &lt;&lt; <span class="stringliteral">&quot; - For face &quot;</span> &lt;&lt; (int)iFace &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; neigh.size() &lt;&lt; <span class="stringliteral">&quot; neighbours: [ &quot;</span>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> iNeigh : neigh) {</div>
<div class="line">                log::cout() &lt;&lt; iNeigh &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            log::cout() &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    log::cout() &lt;&lt; <span class="stringliteral">&quot;Extracting the four vertex neighbours of each Octant &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t iOct = 0; iOct &lt; nOct; ++iOct) {</div>
<div class="line">        std::vector&lt;uint32_t&gt; neigh;</div>
<div class="line">        std::vector&lt;bool&gt; isGhost;</div>
<div class="line">        log::cout() &lt;&lt; <span class="stringliteral">&quot;. Octant index : &quot;</span> &lt;&lt; iOct &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">for</span> (uint8_t iVertex=0; iVertex&lt;pablo11.<a id="a9" name="a9"></a><a class="code hl_function" href="classbitpit_1_1ParaTree.html#a476eaf74d8a455fdc2b9526358c99a76">getNnodes</a>(); ++iVertex) {</div>
<div class="line">            pablo11.<a class="code hl_function" href="classbitpit_1_1ParaTree.html#a68ce3495da48681134c439abc47db841">findNeighbours</a>(iOct, iVertex, 3, neigh, isGhost);</div>
<div class="line">            log::cout() &lt;&lt; <span class="stringliteral">&quot; - For vertex &quot;</span> &lt;&lt; (int)iVertex &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; neigh.size() &lt;&lt; <span class="stringliteral">&quot; neighbours: [ &quot;</span>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> iNeigh: neigh) {</div>
<div class="line">                log::cout() &lt;&lt; iNeigh &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            log::cout() &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    log::cout() &lt;&lt; <span class="stringliteral">&quot;Extracting the four edge neighbours of each Octant &quot;</span> &lt;&lt; std::endl;</div>
<div class="line">    <span class="keywordflow">for</span> (uint32_t iOct=0; iOct &lt; nOct; ++iOct) {</div>
<div class="line">        std::vector&lt;uint32_t&gt; neigh;</div>
<div class="line">        std::vector&lt;bool&gt; isGhost;</div>
<div class="line">        log::cout() &lt;&lt; <span class="stringliteral">&quot;. Octant index : &quot;</span> &lt;&lt; iOct &lt;&lt; std::endl;</div>
<div class="line">        <span class="keywordflow">for</span> (uint8_t iEdge = 0; iEdge&lt;pablo11.<a id="a10" name="a10"></a><a class="code hl_function" href="classbitpit_1_1ParaTree.html#aa8500894a157a585dcf61eb8c94eafae">getNedges</a>(); ++iEdge) {</div>
<div class="line">            pablo11.<a class="code hl_function" href="classbitpit_1_1ParaTree.html#a68ce3495da48681134c439abc47db841">findNeighbours</a>(iOct, iEdge, 2, neigh, isGhost);</div>
<div class="line">            log::cout() &lt;&lt; <span class="stringliteral">&quot; - For edge &quot;</span> &lt;&lt; (int)iEdge &lt;&lt; <span class="stringliteral">&quot;; &quot;</span> &lt;&lt; neigh.size() &lt;&lt; <span class="stringliteral">&quot; neighbours: [ &quot;</span>;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> iNeigh: neigh) {</div>
<div class="line">                log::cout() &lt;&lt; iNeigh &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line">            }</div>
<div class="line">            log::cout() &lt;&lt; <span class="stringliteral">&quot;]&quot;</span> &lt;&lt; std::endl;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line"><span class="preprocessor">#if BITPIT_ENABLE_MPI==1</span></div>
<div class="line">    MPI_Init(&amp;argc,&amp;argv);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    <a id="a11" name="a11"></a><a class="code hl_define" href="group__common__macro.html#gacb5eef7cdb2adda3b65bfe01c66667a4">BITPIT_UNUSED</a>(argc);</div>
<div class="line">    <a class="code hl_define" href="group__common__macro.html#gacb5eef7cdb2adda3b65bfe01c66667a4">BITPIT_UNUSED</a>(argv);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> nProcs;</div>
<div class="line">    <span class="keywordtype">int</span> rank;</div>
<div class="line"><span class="preprocessor">#if BITPIT_ENABLE_MPI==1</span></div>
<div class="line">    MPI_Comm_size(MPI_COMM_WORLD, &amp;nProcs);</div>
<div class="line">    MPI_Comm_rank(MPI_COMM_WORLD, &amp;rank);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    nProcs = 1;</div>
<div class="line">    rank   = 0;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Initialize the logger</span></div>
<div class="line">    log::manager().initialize(log::MODE_SEPARATE, <span class="keyword">false</span>, nProcs, rank);</div>
<div class="line">    log::cout() &lt;&lt; log::fileVerbosity(log::LEVEL_INFO);</div>
<div class="line">    log::cout() &lt;&lt; log::disableConsole();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Run the example</span></div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">        run();</div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;exception) {</div>
<div class="line">        log::cout() &lt;&lt; exception.what();</div>
<div class="line">        exit(1);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if BITPIT_ENABLE_MPI==1</span></div>
<div class="line">    MPI_Finalize();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassbitpit_1_1PabloUniform_html"><div class="ttname"><a href="classbitpit_1_1PabloUniform.html">bitpit::PabloUniform</a></div><div class="ttdoc">PABLO Uniform is an example of user class derived from ParaTree to map ParaTree in a uniform (square/...</div><div class="ttdef"><b>Definition</b> <a href="PabloUniform_8hpp_source.html#l00061">PabloUniform.hpp:62</a></div></div>
<div class="ttc" id="aclassbitpit_1_1PabloUniform_html_a7bc85b54fb9ed262cad6e4e6d43f8716"><div class="ttname"><a href="classbitpit_1_1PabloUniform.html#a7bc85b54fb9ed262cad6e4e6d43f8716">bitpit::PabloUniform::write</a></div><div class="ttdeci">void write(const std::string &amp;filename)</div><div class="ttdef"><b>Definition</b> <a href="PabloUniform_8cpp_source.html#l00881">PabloUniform.cpp:881</a></div></div>
<div class="ttc" id="aclassbitpit_1_1ParaTree_html_a1494818960f36f09090597a10eac9fff"><div class="ttname"><a href="classbitpit_1_1ParaTree.html#a1494818960f36f09090597a10eac9fff">bitpit::ParaTree::getNumOctants</a></div><div class="ttdeci">uint32_t getNumOctants() const</div><div class="ttdef"><b>Definition</b> <a href="ParaTree_8cpp_source.html#l02118">ParaTree.cpp:2118</a></div></div>
<div class="ttc" id="aclassbitpit_1_1ParaTree_html_a41d99b9833493d8b18bf927418bf7598"><div class="ttname"><a href="classbitpit_1_1ParaTree.html#a41d99b9833493d8b18bf927418bf7598">bitpit::ParaTree::computeConnectivity</a></div><div class="ttdeci">void computeConnectivity()</div><div class="ttdef"><b>Definition</b> <a href="ParaTree_8cpp_source.html#l03955">ParaTree.cpp:3955</a></div></div>
<div class="ttc" id="aclassbitpit_1_1ParaTree_html_a476eaf74d8a455fdc2b9526358c99a76"><div class="ttname"><a href="classbitpit_1_1ParaTree.html#a476eaf74d8a455fdc2b9526358c99a76">bitpit::ParaTree::getNnodes</a></div><div class="ttdeci">uint8_t getNnodes() const</div><div class="ttdef"><b>Definition</b> <a href="ParaTree_8cpp_source.html#l01039">ParaTree.cpp:1039</a></div></div>
<div class="ttc" id="aclassbitpit_1_1ParaTree_html_a5eacb88f2324b915ba8dbac95c994755"><div class="ttname"><a href="classbitpit_1_1ParaTree.html#a5eacb88f2324b915ba8dbac95c994755">bitpit::ParaTree::adaptGlobalRefine</a></div><div class="ttdeci">bool adaptGlobalRefine(bool mapper_flag=false)</div><div class="ttdef"><b>Definition</b> <a href="ParaTree_8cpp_source.html#l03713">ParaTree.cpp:3713</a></div></div>
<div class="ttc" id="aclassbitpit_1_1ParaTree_html_a68ce3495da48681134c439abc47db841"><div class="ttname"><a href="classbitpit_1_1ParaTree.html#a68ce3495da48681134c439abc47db841">bitpit::ParaTree::findNeighbours</a></div><div class="ttdeci">void findNeighbours(uint32_t idx, uint8_t face, uint8_t codim, u32vector &amp;neighbours, bvector &amp;isghost) const</div><div class="ttdef"><b>Definition</b> <a href="ParaTree_8cpp_source.html#l02679">ParaTree.cpp:2679</a></div></div>
<div class="ttc" id="aclassbitpit_1_1ParaTree_html_aa8500894a157a585dcf61eb8c94eafae"><div class="ttname"><a href="classbitpit_1_1ParaTree.html#aa8500894a157a585dcf61eb8c94eafae">bitpit::ParaTree::getNedges</a></div><div class="ttdeci">uint8_t getNedges() const</div><div class="ttdef"><b>Definition</b> <a href="ParaTree_8cpp_source.html#l01055">ParaTree.cpp:1055</a></div></div>
<div class="ttc" id="aclassbitpit_1_1ParaTree_html_ab4aa4521f6f8b2c046ad2bcb57bf568d"><div class="ttname"><a href="classbitpit_1_1ParaTree.html#ab4aa4521f6f8b2c046ad2bcb57bf568d">bitpit::ParaTree::updateConnectivity</a></div><div class="ttdeci">void updateConnectivity()</div><div class="ttdef"><b>Definition</b> <a href="ParaTree_8cpp_source.html#l03972">ParaTree.cpp:3972</a></div></div>
<div class="ttc" id="aclassbitpit_1_1ParaTree_html_ab63134bd6077b2cdb109cc3b51fc8951"><div class="ttname"><a href="classbitpit_1_1ParaTree.html#ab63134bd6077b2cdb109cc3b51fc8951">bitpit::ParaTree::getNfaces</a></div><div class="ttdeci">uint8_t getNfaces() const</div><div class="ttdef"><b>Definition</b> <a href="ParaTree_8cpp_source.html#l01047">ParaTree.cpp:1047</a></div></div>
<div class="ttc" id="aclassbitpit_1_1ParaTree_html_ad6b41c3482514a04d177f8c414d4ac75"><div class="ttname"><a href="classbitpit_1_1ParaTree.html#ad6b41c3482514a04d177f8c414d4ac75">bitpit::ParaTree::setPeriodic</a></div><div class="ttdeci">void setPeriodic(uint8_t i)</div><div class="ttdef"><b>Definition</b> <a href="ParaTree_8cpp_source.html#l01252">ParaTree.cpp:1252</a></div></div>
<div class="ttc" id="agroup__common__macro_html_gacb5eef7cdb2adda3b65bfe01c66667a4"><div class="ttname"><a href="group__common__macro.html#gacb5eef7cdb2adda3b65bfe01c66667a4">BITPIT_UNUSED</a></div><div class="ttdeci">#define BITPIT_UNUSED(variable)</div><div class="ttdef"><b>Definition</b> <a href="compiler_8hpp_source.html#l00063">compiler.hpp:63</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
---
layout: doxygen_footer
---
{% endraw %}
<!-- HTML footer for doxygen 1.8.9.1-->
<!-- start footer part -->
<address class="footer"><small>
Generated on Fri Apr 26 2024 10:45:52 for bitpit by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.10.0
</small></address>
